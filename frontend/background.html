<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Background</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"
      integrity="sha512-N4kV7GkNv7QR7RX9YF/olywyIgIwNvfEe2nZtfyj73HdjCUkAfOBDbcuJ/cTaN04JKRnw1YG1wnUyNKMsNgg3g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      // Adapted from a sketch from by yasai: https://openprocessing.org/sketch/494102

      var particles_a = [];
      var particles_b = [];
      var particles_c = [];
      var nums = 0;
      var noiseScale = 400;

      var backgroundColor;
      var particleColors = [];

      function windowResized() {
        setup();
      }

      function setup() {
        // The number of points is proportional to the area
        nums = Math.round((windowWidth * windowHeight) / 2000);

        // Colors used in the site with some alpha
        backgroundColor = color("#191724");
        particleColors = [
          color("#6b4f8f1f"),
          color("#9d7ec21f"),
          color("#c9d1d91f"),
        ];

        createCanvas(windowWidth, windowHeight);

        background(backgroundColor);

        // Particles have a 100px area to go outside the viewing area for better edges
        for (var i = 0; i < nums; i++) {
          particles_a[i] = new Particle(
            random(-100, width + 100),
            random(-100, height + 100)
          );
          particles_b[i] = new Particle(
            random(-100, width + 100),
            random(-100, height + 100)
          );
          particles_c[i] = new Particle(
            random(-100, width + 100),
            random(-100, height + 100)
          );
        }
      }

      function draw() {
        smooth();
        for (var i = 0; i < nums; i++) {
          var radius = map(i, 0, nums, 1, 2);
          var weight = map(i, 0, nums, 0.05, 2);

          strokeWeight(weight);
          stroke(particleColors[0]);
          particles_a[i].move();
          particles_a[i].display(radius);
          particles_a[i].checkEdge();

          strokeWeight(weight);
          stroke(particleColors[1]);
          particles_b[i].move();
          particles_b[i].display(radius);
          particles_b[i].checkEdge();

          strokeWeight(weight);
          stroke(particleColors[2]);
          particles_c[i].move();
          particles_c[i].display(radius);
          particles_c[i].checkEdge();
        }
      }

      function Particle(x, y) {
        this.dir = createVector(0, 0);
        this.vel = createVector(0, 0);
        this.pos = createVector(x, y);
        this.last_pos = this.pos;
        this.speed = 0.4;
        this.angle =
          noise(this.pos.x / noiseScale, this.pos.y / noiseScale) *
          TWO_PI *
          noiseScale;

        this.move = function () {
          var newAngle =
            noise(this.pos.x / noiseScale, this.pos.y / noiseScale) *
            TWO_PI *
            noiseScale;

          this.last_pos = this.pos;

          // This makes the movement more smooth
          this.angle = (this.angle + newAngle) / 2;

          this.dir.x = cos(this.angle / 2);
          this.dir.y = sin(this.angle / 2);
          this.vel = this.dir.copy();

          this.vel.mult(this.speed);
          this.pos.add(this.vel);
        };

        this.checkEdge = function () {
          if (
            this.pos.x > width + 100 ||
            this.pos.x < -100 ||
            this.pos.y > height + 100 ||
            this.pos.y < -100
          ) {
            this.pos.x = random(100, width);
            this.pos.y = random(100, height);
          }
        };

        this.display = function (r) {
          line(this.pos.x, this.pos.y, this.last_pos.x, this.last_pos.y);
        };
      }
    </script>
    <style>
      * {
        margin: 0px;
        overflow: hidden;
      }
    </style>
  </head>
  <body></body>
</html>
